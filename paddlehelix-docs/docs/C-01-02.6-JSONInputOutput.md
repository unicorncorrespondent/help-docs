# HF3/S1 输入 JSON 与输出数据说明

<div class="doc-page-type doc-page-type--input"><span class="doc-page-type__icon">🧪</span><span>分类：输入</span></div>


> 面向 HelixFold3 / HelixFold-S1 的输入规范、输出文件结构与评分字段解释。

## 快速导航

- [快速上手](#快速上手)
- [输入 JSON 结构总览](#输入-json-结构总览)
- [实体类型与修饰](#实体类型与修饰)
- [HF3 距离约束](#hf3-距离约束仅-hf3)
- [HF-S1 接触采样范围](#hf-s1-接触采样范围仅-hf-s1)
- [多任务 JSON 示例](#多任务-json-示例)
- [输出文件结构](#输出文件结构)
- [summarycsv 核心字段](#summarycsv-核心字段)
- [all_resultsjson 字段速查](#all_resultsjson-字段速查)
- [附录](#附录)

## 快速上手

无论您通过网页端还是 API/SDK 使用 **HelixFold3**，均可使用 JSON 作为输入格式。该格式特别适合自动化与批量建模任务。

1. 在网页端配置任务，导出 JSON 作为模板。
2. 按模板修改任务参数和实体内容。
3. 在网页端点击“上传 JSON”或通过 API/SDK 提交。

说明：

- 网页端：支持一个 JSON 文件内提交多个任务。
- API/SDK：可直接传 JSON 对象或 JSON 文件路径。参考 [API与SDK说明](./C-01-02.7-APISDKGuide)。

### 最小可用模板

```json
[
  {
    "model_type": "HelixFold3",
    "job_name": "demo_job",
    "recycle": 10,
    "ensemble": 1,
    "entities": [
      {
        "type": "protein",
        "sequence": "ATQGVFTLPANTRFGVTAFANSSGTQTVNVLVNNETAATFSGQSTNNAVIGTQVLNSGSSGKVQVQVSVNGRPSDLVSAQVILTNELNFALVGSEDGTDNDYNDAVVVINWPLG",
        "count": 1
      }
    ]
  }
]
```

## 输入 JSON 结构总览

JSON 顶层是“任务对象数组”，每个对象代表一个任务。一个文件可提交多个任务。

### 顶层字段速查

| 字段 | 必填 | 说明 | 取值 / 默认值 |
| --- | --- | --- | --- |
| `model_type` | 否 | 模型类型 | `HelixFold3`（默认）或 `HelixFold-S1` |
| `job_name` | 否 | 任务名称 | 字符串 |
| `recycle` | 否 | 推理迭代参数 | `[10, 100]`，默认 `10` |
| `ensemble` | 否 | HF3 为推理次数；HF-S1 为接触采样次数 | HF3: `[1,100]` 默认 `1`；HF-S1: `[5,100]` 默认 `5` |
| `entities` | 是 | 参与预测的实体列表 | 见下文 |
| `constraint` | 否 | 残基间距离约束（仅 HF3） | 最多 10 组 |
| `s1_sample_constraint` | 否 | 接触采样范围（仅 HF-S1） | 见下文 |

## 实体类型与修饰

`entities` 为数组。单任务中所有实体的 token 总数必须 <= **3000**。

### 实体类型速查

| `type` | 说明 |
| --- | --- |
| `protein` | 蛋白质单链 |
| `dna` | DNA 单链 |
| `rna` | RNA 单链 |
| `ligand` | 小分子配体 |
| `ion` | 离子 |

### 通用说明

- `count` 表示该实体复制数量。
- 链类实体（protein/dna/rna）通常使用 `sequence` + `count`。
- `ligand` 使用 `ccd` 或 `smiles`（二选一；若同时给出，以 `ccd` 为准）。
- `ion` 使用 `ccd` + `count`。

### 蛋白质（protein）

关键字段：

- `sequence`（必填）：20 种标准氨基酸序列。
- `count`（必填）：复制数量。
- `modifications`（可选）：修饰数组。

`modifications` 每项字段：

- `type`：`residue_replace` 或 `sidechain_replace`
- `index`：修饰位点（从 1 开始）
- `ccd`：用于 `residue_replace`，取值见[蛋白质修饰残基](#蛋白质修饰残基)
- `R_smiles`：用于 `sidechain_replace`（重原子数 <= 100）
- `R_connect_idx`：与主链 Cα 相连原子索引（从 0 开始）

![蛋白质侧链任意修饰示意图](https://bml-test-test.bj.bcebos.com/helix_upload/protein_mod-eb5149ed.png)

```json
{
  "type": "protein",
  "sequence": "AGPDSMEEVVVPEEPPKLVSALATYVQQERLCTMFLSIANKLLPLKP",
  "count": 1,
  "modifications": [
    {
      "type": "residue_replace",
      "index": 1,
      "ccd": "CIR"
    },
    {
      "type": "sidechain_replace",
      "index": 4,
      "R_smiles": "COP(=O)(O)O",
      "R_connect_idx": 0
    }
  ]
}
```

### DNA（dna）

说明：`dna` 表示单链 DNA。双链 DNA 需添加第二个 `dna` 实体并输入互补链。

关键字段：

- `sequence`（必填）：仅支持 A/T/C/G。
- `count`（必填）：复制数量。
- `modifications`（可选）：格式同蛋白，连接位点为核苷酸骨架 C1'。

![DNA 侧链任意修饰示意图](https://bml-test-test.bj.bcebos.com/helix_upload/dna_mod-8b339cfd.png)

```json
{
  "type": "dna",
  "sequence": "ACGTTTACGGGG",
  "count": 1,
  "modifications": [
    {
      "type": "residue_replace",
      "index": 3,
      "ccd": "OXG"
    },
    {
      "type": "sidechain_replace",
      "index": 6,
      "R_smiles": "Cc1c[nH]c(=O)nc1N",
      "R_connect_idx": 3
    }
  ]
}
```

### RNA（rna）

关键字段：

- `sequence`（必填）：仅支持 A/U/C/G。
- `count`（必填）：复制数量。
- `modifications`（可选）：格式同 DNA。

![RNA 侧链任意修饰示意图](https://bml-test-test.bj.bcebos.com/helix_upload/rna_mod-54ef0f11.png)

```json
{
  "type": "rna",
  "sequence": "ACCCCCCC",
  "count": 1,
  "modifications": [
    {
      "type": "residue_replace",
      "index": 3,
      "ccd": "5MC"
    },
    {
      "type": "sidechain_replace",
      "index": 5,
      "R_smiles": "Cc1c[nH]c(=O)nc1N",
      "R_connect_idx": 3
    }
  ]
}
```

### 小分子配体（ligand）

可通过 `ccd` 或 `smiles` 指定（互斥，若同时存在以 `ccd` 为准）。

- `ccd`：来自 [RCSB CCD 数据库](https://www.wwpdb.org/data/ccd)
- `smiles`：重原子数 <= 100
- `count`（必填）：整数，<= 50

```json
{
  "type": "ligand",
  "ccd": "ATP",
  "count": 1
}
```

```json
{
  "type": "ligand",
  "smiles": "CCccc(O)ccc",
  "count": 1
}
```

不支持的 CCD 见[附录：不支持的 CCD 列表](#附录不支持的-ccd-列表)。

### 离子（ion）

- `ccd`（必填）：离子 CCD 编码
- `count`（必填）：整数，<= 50

支持离子：`MG`, `ZN`, `CL`, `CA`, `NA`, `MN`, `MN3`, `K`, `FE`, `FE2`, `CU`, `CU1`, `CU3`, `CO`。

```json
{
  "type": "ion",
  "ccd": "ZN",
  "count": 1
}
```

:::tip
如需指定价态，建议改用 `ligand + smiles`，例如 `[Cu2+]`。
:::

## HF3 距离约束（仅 HF3）

`constraint` 为可选数组，最多 10 组约束。

每项字段：

- `type`：当前仅支持 `"distance"`
- `level`：当前仅支持 `"residue"`
- `left_entity`：`实体序号-实体复制编号-残基编号`（均从 1 开始）
- `right_entity`：同上
- `distance`（可选）：约束距离（Å），范围 `[2,20]`，默认 `5`

```json
{
  "job_name": "demo_constraint",
  "constraint": [
    {
      "type": "distance",
      "level": "residue",
      "left_entity": "1-1-4",
      "right_entity": "3-2-10",
      "distance": 6
    }
  ],
  "entities": [
    {
      "type": "dna",
      "sequence": "ACGTTTACGGGGATCGGGATCCCG",
      "count": 1
    },
    {
      "type": "rna",
      "sequence": "ACGUUUACGGGGACGGGG",
      "count": 1
    },
    {
      "type": "protein",
      "sequence": "GPDSMEEVVVPEEPPKLVSALATYVQQERLCTMFLSIANKLLPLKPGPDSMEEVVVPEEPPKLV",
      "count": 2
    }
  ]
}
```

## HF-S1 接触采样范围（仅 HF-S1）

`s1_sample_constraint` 仅在 `model_type = "HelixFold-S1"` 时生效。

每项字段：

- `left_entity`：`实体序号-实体复制编号`
- `right_entity`：`实体序号-实体复制编号`

多个采样条件之间是“或”关系，例如：

`[{"left_entity": "1-1", "right_entity": "1-2"}, {"left_entity": "2-1", "right_entity": "3-1"}]`

表示采样范围为（1-1 与 1-2）或（2-1 与 3-1）。

```json
{
  "job_name": "Example-S1",
  "model_type": "HelixFold-S1",
  "entities": [
    {
      "type": "protein",
      "sequence": "AGPDSMEEVVVPEEPPKLVSALATYVQQERLCTMFLSIANKLLPLKP",
      "count": 2
    },
    {
      "type": "protein",
      "sequence": "AGPDSMEEVVVPEEPPKLV",
      "count": 1
    },
    {
      "type": "ligand",
      "ccd": "ATP",
      "count": 1
    }
  ],
  "s1_sample_constraint": [
    {
      "left_entity": "1-1",
      "right_entity": "1-2"
    },
    {
      "left_entity": "2-1",
      "right_entity": "3-1"
    }
  ]
}
```

## 多任务 JSON 示例

```json
[
  {
    "job_name": "job_1",
    "entities": [
      {
        "type": "protein",
        "count": 1,
        "sequence": "TFCGETCRVIPVCTYSAALGCTCDDRSDGLCKRNGDP"
      }
    ]
  },
  {
    "job_name": "job_4",
    "entities": [
      {
        "type": "protein",
        "count": 1,
        "sequence": "TSASEDIDFDDLSRRFEELKKKT"
      }
    ]
  }
]
```

## 输出文件结构

点击“下载结果”后会得到 zip 包，解压目录示例：

```text
helixfold3_result_to_download_task_name_time.zip/
├── user_input.json
├── Terms_of_Use
├── 使用条款
├── summary.csv
├── *-<ensemble_id>-rank<rank_id>/
│   ├── all_results.json
│   ├── chain_id_mapping.csv
│   └── predicted_structure.cif
└── interface_infos/  (仅 HelixFold-S1)
    ├── predicted_interface.json
    └── predicted_interface.png
```

常用文件说明：

- `user_input.json`：任务输入备份。
- `summary.csv`：所有候选结构的汇总评分。
- `all_results.json`：单个候选结构的完整评分明细。
- `chain_id_mapping.csv`：输入实体与输出链 ID 映射。
- `predicted_structure.cif`：结构文件。
- `interface_infos/`：S1 才会输出，包含界面预测概率。

## summary.csv 核心字段

| 字段 | 说明 |
| --- | --- |
| `model_id` | 结构 ID，与结果文件夹对应。 |
| `has_clash` | 是否存在大范围原子碰撞（0/1）。 |
| `global_ptm` | 全局 pTM（0-1），反映整体结构精度。 |
| `global_iptm` | 全局 ipTM（0-1），反映界面精度均值；单链为 `null`。 |
| `global_plddt` | 全局 pLDDT（0-100），反映局部结构可信度。 |
| `ranking_confidence` | 结果排序分数（综合 ipTM/pTM/碰撞项）。 |
| `sampling_left_entity`（S1） | S1 采样左实体。 |
| `sampling_right_entity`（S1） | S1 采样右实体。 |
| `sampling_probability`（S1） | S1 采样接触概率（0-1）。 |

## all_results.json 字段速查

对于原子总数 `[num_atoms]`、token 总数 `[num_tokens]`、链总数 `[num_chains]` 的任务：

### 原子级字段

| 字段名（历史名） | 说明 |
| --- | --- |
| `atom_chain_ids`（`atom_chain_id`） | `[num_atoms]`，每个原子对应链 ID。 |
| `atom_plddt` | `[num_atoms]`，原子级 pLDDT。 |

### Token 级字段

| 字段名（历史名） | 说明 |
| --- | --- |
| `token_plddt`（`plddt`） | `[num_tokens]`，token 级 pLDDT。 |
| `token_has_clash` | `[num_tokens]`，token 是否与其他链冲突。 |
| `token_chain_ids`（`chain_id`） | `[num_tokens]`，token 对应链 ID。 |
| `token_res_ids`（`res_id`） | `[num_tokens]`，链内 token 编号。 |
| `token_ptm` | `[num_tokens]`，token 级 pTM。 |
| `token_pair_pae`（`pae`） | `[num_tokens, num_tokens]`，token 对 PAE。 |

### 链级字段

| 字段 | 说明 |
| --- | --- |
| `chain_has_clash` | `[num_chains, num_chains]`，链间是否碰撞。 |
| `chain_plddt` | `[num_chains]`，链级 pLDDT。 |
| `chain_pair_iptm` | `[num_chains, num_chains]`，链对界面 ipTM。 |
| `chain_ptm` | `[num_chains]`，链级 pTM。 |
| `chain_pair_iptm_min` | `[num_chains]`，每条链与其他链最小 ipTM。 |
| `chain_pair_pae_min` | `[num_chains, num_chains]`，链对最小 PAE。 |
| `chain_pair_pae` | `[num_chains, num_chains]`，链对平均 PAE。 |

### 全局字段

| 字段名（历史名） | 说明 |
| --- | --- |
| `global_pae`（`avg_pae`） | 全局 PAE 均值。 |
| `global_pae_min`（`min_pae`） | 全局 PAE 最小值。 |
| `global_iptm`（`iptm`） | 全局 ipTM。 |
| `global_iptm_min`（`min_iptm`） | 全局最小 ipTM。 |
| `global_ptm`（`ptm`） | 全局 pTM。 |
| `global_has_clash` | 全局碰撞标记。 |
| `global_plddt`（`avg_plddt`） | 全局 pLDDT。 |
| `ranking_confidence` | 结构排序分数。 |

:::tip
注：历史字段名仍保留用于兼容，建议优先使用新字段名。
:::

## 常见错误排查

- 报 token 超限：检查 `entities` 总 token 是否 > 3000。
- 双链 DNA 只输入一条链：需要再添加一个 `dna` 实体并写互补链。
- `ligand` 同时填写 `ccd` 和 `smiles`：系统会优先使用 `ccd`。
- HF-S1 采样约束未生效：确认 `model_type` 已设为 `HelixFold-S1`。
- 修饰字段报错：确认 `index` 从 1 开始，`R_connect_idx` 从 0 开始。

## 附录：残基替换型修饰列表

### 蛋白质修饰残基

| 标准氨基酸 | 修饰 CCD | 修饰残基英文名称 | 修饰残基中文名 |
| --- | --- | --- | --- |
| R | 2MR | N3,N4-Dimethyl-L-arginine | N3,N4-二甲基-L-精氨酸 |
| R | AGM | 5-Methyl-L-arginine | 5-甲基-L-精氨酸 |
| R | CIR | Citrulline | 瓜氨酸 |
| C | MCS | Malonyl cysteine | 丙二酰半胱氨酸 |
| C | P1L | S-Palmitoyl-L-cysteine | S-棕榈酰-L-半胱氨酸 |
| C | SNC | S-Nitroso-Cysteine | S-亚硝基半胱氨酸 |
| H | NEP | N1-Phosphohistidine | N1-磷酸组氨酸 |
| H | HIP | ND1-Phosphohistidine | ND1-磷酸组氨酸 |
| K | ALY | N6-Acetyl-L-lysine | N6-乙酰基-L-赖氨酸 |
| K | MLY | N-Dimethyl-L-lysine | N-二甲基-L-赖氨酸 |
| K | M3L | N-Trimethyllysine | N-三甲基赖氨酸 |
| K | MLZ | N6-Methyllysine | N6-甲基赖氨酸 |
| K | LYZ | 5-Hydroxylysine | 5-羟基赖氨酸 |
| K | KCR | N-6-Crotonyl-L-Lysine | N-6-巴豆酰-L-赖氨酸 |
| K | YHA | Homocitrulline | 高瓜氨酸 |
| N | AHB | 3-Hydroxyasparagine | 3-羟基天冬酰胺 |
| N | SNN | L-3-Aminosuccinimide | L-3-氨基琥珀酰亚胺 |
| P | HYP | 4-Hydroxyproline | 4-羟基脯氨酸 |
| P | HY3 | 3-Hydroxyproline | 3-羟基脯氨酸 |
| S | SEP | Phosphoserine | 磷酸丝氨酸 |
| T | TPO | Phosphothreonine | 磷酸苏氨酸 |
| W | TRF | N1-Formyl-Tryptophan | N1-甲酰基色氨酸 |
| Y | PTR | O-Phospho-L-tyrosine | O-磷酸-L-酪氨酸 |

### DNA 修饰残基

| 标准核苷酸 | 修饰 CCD | 修饰残基英文名称 | 修饰残基中文名 |
| --- | --- | --- | --- |
| A | 6MA | N6-Methyl-2-Deoxy-Adenosine | N6-甲基-2'-脱氧腺苷 |
| A | 3DR | abasic dideoxyribose | 无碱基双脱氧核糖 |
| C | 5CM | 5-Methyl-2-Deoxy-Cytidine | 5-甲基-2'-脱氧胞苷 |
| C | C34 | N4-Methyl-2-Deoxy-Cytidine | N4-甲基-2'-脱氧胞苷 |
| C | 5HC | 5-Hydroxymethyl-2-Deoxy-Cytidine | 5-羟甲基-2'-脱氧胞苷 |
| C | 1CC | 5-Carboxy-2-Deoxy-Cytidine | 5-羧基-2'-脱氧胞苷 |
| C | 5FC | 5-Formylcytosine | 5-甲酰基胞嘧啶 |
| C | 3DR | abasic dideoxyribose | 无碱基双脱氧核糖 |
| T | 3DR | abasic dideoxyribose | 无碱基双脱氧核糖 |
| G | 6OG | 6-O-Methyl Guanosine | 6-O-甲基鸟苷 |
| G | 8OG | 8-oxoguanine | 8-氧代鸟嘌呤 |
| G | 3DR | abasic dideoxyribose | 无碱基双脱氧核糖 |

### RNA 修饰残基

| 标准核苷酸 | 修饰 CCD | 修饰残基英文名称 | 修饰残基中文名 |
| --- | --- | --- | --- |
| A | A2M | 2'-O-Methyladenosine | 2'-O-甲基腺苷 |
| A | MA6 | N6-Dimethyladenosine | N6-二甲基腺苷 |
| A | 6MZ | N6-Methyladenosine | N6-甲基腺苷 |
| C | 5MC | 5-Methylcytidine | 5-甲基胞苷 |
| C | OMC | 2'-O-Methylcytidine | 2'-O-甲基胞苷 |
| C | 4OC | N4,2'-O-Dimethylcytidine | N4,2'-O-二甲基胞苷 |
| C | RSQ | 5-Formylcytosine | 5-甲酰基胞嘧啶 |
| U | 5MU | 5-Methyluridine | 5-甲基尿苷 |
| U | OMU | 2'-O-Methyluridine | 2'-O-甲基尿苷 |
| U | UR3 | 3-Methyluridine | 3-甲基尿苷 |
| U | PSU | Pseudouridine | 假尿苷（假尿嘧啶） |
| G | 2MG | 2'-O-Methylguanosine | 2'-O-甲基鸟苷 |
| G | OMG | 2'-O-Methylguanosine | 2'-O-甲基鸟苷 |
| G | 7MG | 7-Methyl-8-hydroguanosine | 7-甲基-8-氢鸟苷 |


## 附录：不支持的 CCD 列表

即使 HF 模型不支持以下配体的 CCD 形式，仍可尝试使用 SMILES 形式输入（预测效果未经系统测试）。

#### 不支持的结晶助剂 CCD

```text
SO4, GOL, EDO, PO4, ACT, PEG, DMS, TRS, PGE, PG4, FMT, EPE, MPD, MES, CD, IOD
```

#### 不支持的配体 CCD

```text
144, 15P, 1PE, 2F2, 2JC, 3HR, 3SY, 7N5, 7PE, 9JE, AAE, ABA, ACE, ACN, ACT, ACY, AZI, BAM, BCN, BCT, BDN, BEN, BME, BO3, BTB, BTC, BU1, C8E, CAD, CAQ, CBM, CCN, CIT, CL, CLR, CM, CMO, CO3, CPT, CXS, D10, DEP, DIO, DMS, DN, DOD, DOX, EDO, EEE, EGL, EOH, EOX, EPE, ETF, FCY, FJO, FLC, FMT, FW5, GOL, GSH, GTT, GYF, HED, IHP, IHS, IMD, IOD, IPA, IPH, LDA, MB3, MEG, MES, MLA, MLI, MOH, MPD, MRD, MSE, MYR, N, NA, NH2, NH4, NHE, NO3, O4B, OHE, OLA, OLC, OMB, OME, OXA, P6G, PE3, PE4, PEG, PEO, PEP, PG0, PG4, PGE, PGR, PLM, PO4, POL, POP, PVO, SAR, SCN, SEO, SEP, SIN, SO4, SPD, SPM, SR, STE, STO, STU, TAR, TBU, TME, TPO, TRS, UNK, UNL, UNX, UPL, URE
```
